if mes . get_message ( ) == "potion_recharge" then local args = mes . get_arguments ( ) 
local argsLen = table . getn ( args ) 
if argsLen < 1 then 
debug ( "no parameters" ) 
return 
end 
local commands = { 
[ "close" ] = { args = 1 } , 
[ "buy" ] = { args = 3 } , 
} 
local cmd = args [ 1 ] 
local cmdArgs = commands [ cmd ] 
if cmdArgs ~= nil and argsLen < cmdArgs . args then 
debug ( "no parameters (need %d parameters)" , cmdArgs . args ) 
return 
end 
if cmd == "close" then 
potion_recharge . close ( ) 
elseif cmd == "charge" then 
local potion_inven_pos = tonumber ( args [ 2 ] ) 
local str_slots = args [ 3 ] 
local slots = { } 
local slots_split = split ( str_slots , "," ) 
for i , slot in pairs ( slots_split ) begin 
if tonumber ( slot ) then 
table . insert ( slots , tonumber ( slot ) ) 
end 
end 
potion_recharge . charge ( potion_inven_pos , slots ) 
end 
 return end 